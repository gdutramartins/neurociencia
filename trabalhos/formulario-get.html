---
layout: default
title: Formul√°rio Goals Errors Train
---

<div
    id="loginOverlay"
    style="position: fixed; inset: 0; background: #fff; z-index: 9999; display: flex; align-items: center; justify-content: center"
>
    <div style="width: 320px">
        <h3>Acesso</h3>

        <select class="neuro-input" id="login_entrevistador">
            <option value="0">Escolha o entrevistador</option>
            <option value="1">Gustavo</option>
            <option value="2">Marlus</option>
            <option value="3">Ronald</option>
            <option value="4">Willian</option>
        </select>

        <input type="password" class="neuro-input" id="login_senha" placeholder="Senha" />

        <button class="btn" onclick="login()">Entrar</button>
    </div>
</div>

<div id="dialogCarregar" class="neuro-auth-overlay" style="display: none">
    <div class="neuro-auth-card">
        <h3 style="margin-top: 0">Carregar entrevista</h3>

        <label class="neuro-label">Selecione uma entrevista</label>
        <select class="neuro-input" id="listaEntrevistas">
            <option value="">Selecione uma entrevista</option>
        </select>

        <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 10px">
            <button class="btn btn-outline btn-sm" onclick="fecharDialogCarregar()">Cancelar</button>
            <button class="btn btn-sm" onclick="confirmarCarregarEntrevista()">Carregar</button>
        </div>
    </div>
</div>

<div class="neuro-form">
    <div class="neuro-toolbar">
        <div class="neuro-toolbar-left">
            <span class="neuro-toolbar-label">Entrevista - <i>vers√£o 2.0</i></span> 
            <span style="font-size: 13px; color: #555"> Salvar, criar novo ou carregar entrevista existente </span>
        </div>

        <div class="neuro-toolbar-actions">
            <button type="button" class="btn btn-sm" onclick="salvarFormulario()">üíæ Salvar</button>

            <button type="button" class="btn btn-sm btn-outline" onclick="novoFormulario()">‚ú® Novo</button>

            <button type="button" class="btn btn-sm btn-ghost" onclick="abrirDialogCarregar()">üìÇ Carregar entrevista</button>
        </div>
    </div>

    <!-- ===== ABAS ===== -->
    <div class="neuro-tabs">
        <div class="neuro-tab active" onclick="openTab(this, 'intencoes')">Inten√ß√¢o</div>
        <div class="neuro-tab" onclick="openTab(this, 'modelo')">Modelo</div>
        <div class="neuro-tab" onclick="openTab(this, 'erros')">Erros</div>
        <div class="neuro-tab" onclick="openTab(this, 'treino')">Treino</div>
    </div>

    <form>
        <input type="hidden" name="formulario_id" id="formulario_id" />
        <input type="hidden" id="auth_entrevistador" name="entrevistador" />
        <input type="hidden" id="auth_senha" name="_senha" />
        <!-- =========================
     CONTEXTO COMUM
     ========================= -->
        <div class="neuro-form__section">
            <h3>Contexto da entrevista</h3>

            <div class="neuro-row">
                <div class="neuro-col">
                    <label class="neuro-label">Entrevistador</label>
                    <select class="neuro-input" id="entrevistador_select" disabled>
                        <option value="0">Escolha o entrevistador</option>
                        <option value="1">Gustavo</option>
                        <option value="2">Marlus</option>
                        <option value="3">Ronald</option>
                        <option value="4">Willian</option>
                    </select>
                </div>
                <div class="neuro-col">
                    <label class="neuro-label">Entrevistado</label>
                    <input class="neuro-input" name="entrevistado" placeholder="Entrevistado" />
                </div>
            </div>

            <div class="neuro-row" style="align-items: center; gap: 10px">
                <div class="neuro-col">
                    <label class="neuro-label">Compet√™ncia</label>
                    <select class="neuro-input" name="tema_mudanca" id="tema_mudanca">
                        <option value="">Selecione o tema da mudan√ßa</option>
                    </select>
                </div>

                <div class="hint-icon" id="temaHint">‚ìò</div>
            </div>

            <div id="temaHintBox" class="tema-hint-box" style="display: none"></div>
            <div style="text-align: right; margin-top: 4px; font-size: 13px">
                <a href="competencias-lideranca.html" target="_blank" class="neuro-link"> Ver detalhes das compet√™ncias ‚Üí </a>
            </div>
        </div>

        <!-- =========================
     FORMUL√ÅRIO 1 ‚Äì INTEN√á√ïES
     ========================= -->
        <div class="neuro-tab-content active" id="intencoes">
            <div class="neuro-form__section">
                <h3>Inten√ß√£o genu√≠na</h3>
                <p>Tamb√©m chamada de ‚Äúinten√ß√£o manifesta‚Äù. Onde est√° a minha/nossa dopamina?</p>
                <textarea class="neuro-textarea neuro-textarea--large" name="intencao_genuina"></textarea>
            </div>

            <div class="neuro-form__section">
                <h3>Inten√ß√£o desejada</h3>
                <p>√â necess√°rio ajustar a inten√ß√£o genu√≠na? Se sim, qual a nova inten√ß√£o?</p>
                <textarea class="neuro-textarea neuro-textarea--large" name="intencao_desejada"></textarea>
            </div>

            <div class="neuro-form__section">
                <h3>Inten√ß√µes concorrentes</h3>
                <p>Quais inten√ß√µes (vetores de for√ßa) antagonizam a inten√ß√£o genu√≠na?</p>
                <textarea class="neuro-textarea" name="intencoes_concorrentes_1"></textarea>
                <textarea class="neuro-textarea" name="intencoes_concorrentes_2"></textarea>
                <textarea class="neuro-textarea" name="intencoes_concorrentes_3"></textarea>
            </div>
        </div>

        <!-- =========================
     FORMUL√ÅRIO 2 ‚Äì MODELO
     ========================= -->
        <div class="neuro-tab-content" id="modelo">
            <div class="neuro-form__section">
                <h3>Quem √© o seu modelo?</h3>
                <input class="neuro-input" name="modelo" />
            </div>

            <div class="neuro-form__section">
                <h3>Comportamentos do modelo</h3>
                <input class="neuro-input" type="text" name="modelo_comportamento_1" placeholder="Comportamento 1" />
                <input class="neuro-input" type="text" name="modelo_comportamento_2" placeholder="Comportamento 2" />
                <input class="neuro-input" type="text" name="modelo_comportamento_3" placeholder="Comportamento 3" />
            </div>
        </div>

        <!-- =========================
     FORMUL√ÅRIO 3 ‚Äì ERROS
     ========================= -->
        <div class="neuro-tab-content" id="erros">
            <div class="neuro-form__section">
                <h3>Pilar 2 ‚Äì Erros</h3>

                <table class="neuro-table">
                    <tr>
                        <th>Comportamento</th>
                        <th>Nomear erro</th>
                        <th>Reconhecer</th>
                        <th>Aceitar</th>
                    </tr>

                    <tr>
                        <td>
                            <strong id="label_erro_1">Comportamento 1</strong>
                        </td>
                        <td>
                            <textarea class="neuro-textarea neuro-textarea--wide" name="erro_nome_1"></textarea>
                        </td>
                        <td class="checkbox-cell">
                            <input type="checkbox" name="erro_reconhecer_1" class="neuro-checkbox" />
                        </td>
                        <td class="checkbox-cell">
                            <input type="checkbox" name="erro_aceitar_1" class="neuro-checkbox" />
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <strong id="label_erro_2">Comportamento 2</strong>
                        </td>
                        <td>
                            <textarea class="neuro-textarea neuro-textarea--wide" name="erro_nome_2"></textarea>
                        </td>
                        <td class="checkbox-cell">
                            <input type="checkbox" name="erro_reconhecer_2" class="neuro-checkbox" />
                        </td>
                        <td class="checkbox-cell">
                            <input type="checkbox" name="erro_aceitar_2" class="neuro-checkbox" />
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <strong id="label_erro_3">Comportamento 3</strong>
                        </td>
                        <td>
                            <textarea class="neuro-textarea neuro-textarea--wide" name="erro_nome_3"></textarea>
                        </td>
                        <td class="checkbox-cell">
                            <input type="checkbox" name="erro_reconhecer_3" class="neuro-checkbox" />
                        </td>
                        <td class="checkbox-cell">
                            <input type="checkbox" name="erro_aceitar_3" class="neuro-checkbox" />
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- =========================
     FORMUL√ÅRIO 4 ‚Äì TREINO
     ========================= -->
        <div class="neuro-tab-content" id="treino">
            <div class="neuro-form__section">
                <h3>Detalhamento do erro</h3>

                <select class="neuro-input" id="treino_comportamento" name="treino_comportamento" onchange="mostrarTreino(this.value)">
                    <option value="">Selecione o comportamento</option>
                    <option value="1">Comportamento 1</option>
                    <option value="2">Comportamento 2</option>
                    <option value="3">Comportamento 3</option>
                </select>
            </div>

            <div id="treino-1" class="treino-detalhe" style="display: none">
                <p>Quando este erro ocorre?</p>
                <textarea class="neuro-textarea" name="erro_quando_1"></textarea>

                <p>Por que ele ocorre?</p>
                <textarea class="neuro-textarea" name="erro_porque_1"></textarea>

                <p>Est√≠mulos emocionais / sinais de alerta</p>
                <textarea class="neuro-textarea" name="erro_estimulos_1"></textarea>

                <p>Qu√£o pr√≥ximo estou/estamos de atingir o comportamento?</p>
                <div class="neuro-proximidade">
                    <label><input type="radio" name="erro_proximidade_1" value="0" /> 0%</label>
                    <label><input type="radio" name="erro_proximidade_1" value="25" /> 25%</label>
                    <label><input type="radio" name="erro_proximidade_1" value="50" /> 50%</label>
                    <label><input type="radio" name="erro_proximidade_1" value="75" /> 75%</label>
                    <label><input type="radio" name="erro_proximidade_1" value="100" /> 100%</label>
                </div>
            </div>

            <div id="treino-2" class="treino-detalhe" style="display: none">
                <p>Quando este erro ocorre?</p>
                <textarea class="neuro-textarea" name="erro_quando_2"></textarea>

                <p>Por que ele ocorre?</p>
                <textarea class="neuro-textarea" name="erro_porque_2"></textarea>

                <p>Est√≠mulos emocionais / sinais de alerta</p>
                <textarea class="neuro-textarea" name="erro_estimulos_2"></textarea>

                <p>Qu√£o pr√≥ximo estou/estamos de atingir o comportamento?</p>
                <div class="neuro-proximidade">
                    <label><input type="radio" name="erro_proximidade_2" value="0" /> 0%</label>
                    <label><input type="radio" name="erro_proximidade_2" value="25" /> 25%</label>
                    <label><input type="radio" name="erro_proximidade_2" value="50" /> 50%</label>
                    <label><input type="radio" name="erro_proximidade_2" value="75" /> 75%</label>
                    <label><input type="radio" name="erro_proximidade_2" value="100" /> 100%</label>
                </div>
            </div>

            <div id="treino-3" class="treino-detalhe" style="display: none">
                <p>Quando este erro ocorre?</p>
                <textarea class="neuro-textarea" name="erro_quando_3"></textarea>

                <p>Por que ele ocorre?</p>
                <textarea class="neuro-textarea" name="erro_porque_3"></textarea>

                <p>Est√≠mulos emocionais / sinais de alerta</p>
                <textarea class="neuro-textarea" name="erro_estimulos_3"></textarea>

                <p>Qu√£o pr√≥ximo estou/estamos de atingir o comportamento?</p>
                <div class="neuro-proximidade">
                    <label><input type="radio" name="erro_proximidade_3" value="0" /> 0%</label>
                    <label><input type="radio" name="erro_proximidade_3" value="25" /> 25%</label>
                    <label><input type="radio" name="erro_proximidade_3" value="50" /> 50%</label>
                    <label><input type="radio" name="erro_proximidade_3" value="75" /> 75%</label>
                    <label><input type="radio" name="erro_proximidade_3" value="100" /> 100%</label>
                </div>
            </div>
        </div>

    </form>
</div>

<div id="loading-overlay" style="display: none">
    <div class="spinner"></div>
</div>

<!-- ===========================================================================================
                               SCRIPTS
     ===========================================================================================   
-->
<script>
    // codigo implantacao AKfycbx-Oi_qSeSTX5dkaWwdi_ov945C8cbcCMDe2Toa7kX3Jo52zqjT7JHDpcLDSVnpzk8u
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzJtui9yjpjWknZXMTdKSZZtw598c5joxUMOJ-xWIZ7i0-plXuoUvJK9dC8VnWM9JIa/exec";

    const TEMAS = {
        autoconsciencia: {
            label: "Autoconsci√™ncia Emocional",
            hint: "Capacidade de reconhecer seus pr√≥prios estados emocionais, entender como eles influenciam decis√µes e comportamentos, e ajustar-se quando necess√°rio. √â a base da intelig√™ncia emocional: um l√≠der que n√£o se percebe n√£o consegue se regular.",
        },
        autorregulacao: {
            label: "Autorregula√ß√£o",
            hint: "Controlar impulsos, frustra√ß√µes e rea√ß√µes autom√°ticas. L√≠deres que regulam bem seus estados internos mant√™m a estabilidade do time, especialmente em ambientes de press√£o.",
        },
        visao: {
            label: "Clareza de Prop√≥sito e Vis√£o",
            hint: "Saber traduzir o ‚Äúpara onde estamos indo‚Äù em objetivos concretos, compreens√≠veis e motivadores. Vis√£o sem clareza vira confus√£o; clareza sem vis√£o vira operacional pesado.",
        },
        comunicacao: {
            label: "Comunica√ß√£o Efetiva",
            hint: "Comunicar com precis√£o, adaptar a mensagem ao perfil do time, ouvir ativamente, checar entendimento, evitar ru√≠dos e subjetividade excessiva. A mensagem √© do l√≠der; o entendimento √© do ouvinte.",
        },
        desenvolver_pessoas: {
            label: "Capacidade de Formar e Desenvolver Pessoas",
            hint: "Identificar talentos, entender gaps e ajudar cada pessoa a melhorar. Inclui delega√ß√£o inteligente, feedback cont√≠nuo e ambiente seguro para aprender.",
        },
        confianca: {
            label: "Habilidade de Criar Confian√ßa",
            hint: "Confian√ßa vem de consist√™ncia entre discurso, a√ß√£o e car√°ter. Sem confian√ßa, n√£o h√° autonomia, criatividade ou velocidade na equipe.",
        },
        tomar_decisoes: {
            label: "Tomada de Decis√£o",
            hint: "Tomar decis√µes considerando dados, riscos, consequ√™ncias, valores e timing. Maus l√≠deres adiam; l√≠deres excelentes resolvem com clareza.",
        },
        resolucao_problemas: {
            label: "Pensamento Cr√≠tico e Resolu√ß√£o de Problemas",
            hint: "Avaliar op√ß√µes com objetividade, separar fatos de opini√µes, evitar vieses e encontrar solu√ß√µes estruturadas.",
        },
        prioridades: {
            label: "Gest√£o de Tempo e Prioridades",
            hint: "Saber dizer n√£o, delegar, definir o que √© urgente, importante e ru√≠do.",
        },
        adaptabilidade: {
            label: "Adaptabilidade",
            hint: "Ambientes, tecnologias e pessoas mudam. O l√≠der que n√£o adapta vira gargalo.",
        },
        motivacao: {
            label: "Motiva√ß√£o e Inspira√ß√£o",
            hint: "Criar significado no trabalho, reconhecer esfor√ßos e incentivar desafios. L√≠deres inspiradores ativam sistemas dopamin√©rgicos de forma saud√°vel.",
        },
        competencia_social: {
            label: "Compet√™ncia Social",
            hint: "Relacionamento, coopera√ß√£o, √©tica, respeito e leitura do clima emocional da equipe.",
        },
        conflitos: {
            label: "Gest√£o de Conflitos",
            hint: "Medir, intervir, mediar e resolver diverg√™ncias antes que cres√ßam. Conflito √© inevit√°vel; caos √© opcional.",
        },
        crescimento: {
            label: "Mentalidade de Crescimento",
            hint: "Aprender r√°pido, encarar erros como informa√ß√£o e n√£o fracasso. Guia equipes mais inovadoras e resilientes.",
        },
    };
</script>

<script>
    function openTab(tabElement, contentId) {
        // remove active de todas as abas
        document.querySelectorAll(".neuro-tab").forEach((t) => t.classList.remove("active"));

        // remove active de todos os conte√∫dos
        document.querySelectorAll(".neuro-tab-content").forEach((c) => c.classList.remove("active"));

        // ativa a aba clicada
        tabElement.classList.add("active");

        // ativa o conte√∫do correspondente
        document.getElementById(contentId).classList.add("active");
    }

    function mostrarErro(valor) {
        // esconde todos os blocos de erro
        document.querySelectorAll(".erro-detalhe").forEach((div) => (div.style.display = "none"));

        // se nada foi selecionado, n√£o mostra nada
        if (!valor) return;

        // mostra o bloco correspondente
        const alvo = document.getElementById("erro-" + valor);
        if (alvo) {
            alvo.style.display = "block";
        }
    }
</script>

<script>
    function coletarFormulario() {
        const dados = {};

        document.querySelectorAll("[name]").forEach((el) => {
            if (el.type === "checkbox") {
                dados[el.name] = el.checked;
            } else if (el.type === "radio") {
                if (el.checked) dados[el.name] = el.value;
            } else {
                dados[el.name] = el.value;
            }
        });

        return dados;
    }
</script>

<script>
    async function salvarFormulario() {
        mostrarLoading();

        try {
            const dados = coletarFormulario();
            const id = document.getElementById("formulario_id").value;

            if (id) {
                dados._action = "update";
                dados._id = id;
            } else {
                dados._action = "create";
            }

            const response = await fetch(SCRIPT_URL, {
                method: "POST",
                body: JSON.stringify(dados),
            });

            const json = await response.json();
            if (json.status === "error") {
                alert("Erro ao salvar o formul√°rio: " + json.message);
                return;
            }
            if (json.status === "created") {
                // ixa o contexto de edi√ß√£o
                document.getElementById("formulario_id").value = json.formulario_id;
                alert("Formul√°rio criado e salvo");
            } else if (json.status === "updated") {
                alert("Formul√°rio atualizado");
            }

            // üîÑ atualiza lista, mas mant√©m contexto
            carregarListaEntrevistas();
        } finally {
            esconderLoading();
        }
    }
</script>

<script>
    function limparFormulario() {
        document.querySelectorAll("[name]").forEach((el) => {
            if (el.name === "entrevistador" || el.name === "_senha") return;

            if (el.type === "checkbox" || el.type === "radio") {
                el.checked = false;
            } else {
                el.value = "";
            }
        });

        // garante limpeza expl√≠cita do ID
        const hiddenId = document.getElementById("formulario_id");
        if (hiddenId) hiddenId.value = "";

        const selectUI = document.getElementById("entrevistador_select");
        selectUI.value = document.getElementById("auth_entrevistador").value;
        selectUI.disabled = true;

        // opcional: voltar para a primeira aba
        document.querySelectorAll(".neuro-tab").forEach((t) => t.classList.remove("active"));
        document.querySelectorAll(".neuro-tab-content").forEach((c) => c.classList.remove("active"));

        document.querySelector(".neuro-tab").classList.add("active");
        document.querySelector(".neuro-tab-content").classList.add("active");
    }
</script>

<script>
    function getQueryParam(nome) {
        const params = new URLSearchParams(window.location.search);
        return params.get(nome);
    }
</script>

<script>
    async function carregarFormularioPorId(id) {
        mostrarLoading();

        const auth = getAuth();

        try {
            const url =
                `${SCRIPT_URL}?id=${id}` + `&entrevistador=${encodeURIComponent(auth.entrevistador)}` + `&_senha=${encodeURIComponent(auth.senha)}`;
            const response = await fetch(url);
            const registros = await response.json();

            if (registros.status === "error") {
                alert(registros.message);
                return;
            }

            if (!registros.length) {
                alert("Formul√°rio n√£o encontrado");
                return;
            }

            console.log(registros);

            const payload = JSON.parse(registros[0].payload);

            Object.entries(payload).forEach(([k, v]) => {
                const elements = document.querySelectorAll(`[name="${k}"]`);
                if (!elements.length) return;

                elements.forEach((el) => {
                    if (el.type === "checkbox") {
                        el.checked = Boolean(v);
                    } else if (el.type === "radio") {
                        el.checked = String(el.value) === String(v);
                    } else {
                        el.value = v;
                    }
                });
            });

            document.getElementById("formulario_id").value = registros[0].formulario_id;

            document.getElementById("tema_mudanca").value = payload.tema_mudanca;
            atualizarHintTema();

            atualizarLabelsComportamentos();
        } finally {
            esconderLoading();
        }
    }
</script>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const id = getQueryParam("id");
        if (id) {
            carregarFormularioPorId(id);
        }
    });
</script>

<script>
    function mostrarLoading() {
        document.getElementById("loading-overlay").style.display = "flex";
    }

    function esconderLoading() {
        document.getElementById("loading-overlay").style.display = "none";
    }
</script>

<script>
    const temaSelect = document.getElementById("tema_mudanca");
    const hintBox = document.getElementById("temaHintBox");
    const hintIcon = document.getElementById("temaHint");

    function atualizarHintTema() {
        if (!temaSelect.value) return;

        if (TEMAS[temaSelect.value]) {
            hintBox.innerText = TEMAS[temaSelect.value].hint;
            hintBox.style.display = "block";
        } else {
            hintBox.style.display = "none";
        }
    }

    temaSelect.addEventListener("change", atualizarHintTema);
    hintIcon.addEventListener("mouseenter", atualizarHintTema);
    hintIcon.addEventListener("mouseleave", () => {
        hintBox.style.display = "none";
    });
</script>

<script>
    function atualizarLabelsComportamentos() {
        for (let i = 1; i <= 3; i++) {
            const input = document.querySelector(`[name="modelo_comportamento_${i}"]`);
            const labelErro = document.getElementById(`label_erro_${i}`);

            if (!labelErro) continue;

            if (input && input.value.trim() !== "") {
                labelErro.innerText = input.value;
            } else {
                labelErro.innerText = `Comportamento ${i}`;
            }
        }

        atualizarSelectTreino();
    }
</script>

<script>
    document.querySelectorAll('[name^="modelo_comportamento_"]').forEach((el) => {
        el.addEventListener("input", atualizarLabelsComportamentos);
    });
</script>

<script>
    function atualizarSelectTreino() {
        const select = document.getElementById("treino_comportamento");
        if (!select) return;

        for (let i = 1; i <= 3; i++) {
            const input = document.querySelector(`[name="modelo_comportamento_${i}"]`);
            const option = select.querySelector(`option[value="${i}"]`);

            if (!option) continue;

            if (input && input.value.trim() !== "") {
                option.text = input.value;
            } else {
                option.text = `Comportamento ${i}`;
            }
        }
    }
</script>

<script>
    function mostrarTreino(valor) {
        // esconde todos os blocos de treino
        document.querySelectorAll(".treino-detalhe").forEach((div) => (div.style.display = "none"));

        // se nada foi selecionado, n√£o mostra nada
        if (!valor) return;

        // mostra o bloco correspondente
        const alvo = document.getElementById("treino-" + valor);
        if (alvo) {
            alvo.style.display = "block";
        }
    }
</script>

<script>
    function getAuth() {
        return {
            entrevistador: document.getElementById("auth_entrevistador").value,
            senha: document.getElementById("auth_senha").value,
        };
    }

    async function login() {
        mostrarLoading();
        try {
            const entrevistador = document.getElementById("login_entrevistador").value;
            const senha = document.getElementById("login_senha").value;

            if (!entrevistador || entrevistador === "0" || !senha) {
                alert("Informe entrevistador e senha");
                return;
            }

            // testamos autenticando via backend (sem salvar nada)
            const res = await fetch(SCRIPT_URL, {
                method: "POST",
                body: JSON.stringify({
                    entrevistador,
                    _senha: senha,
                    _action: "auth",
                }),
            });

            const json = await res.json();

            if (json.status !== "ok") {
                alert("Usu√°rio ou senha inv√°lidos");
                return;
            }

            // guarda credenciais em mem√≥ria (hidden)
            document.getElementById("auth_entrevistador").value = entrevistador;
            document.getElementById("auth_senha").value = senha;

            // UI
            const selectUI = document.getElementById("entrevistador_select");
            selectUI.value = entrevistador;
            selectUI.disabled = true;

            // fecha login
            document.getElementById("loginOverlay").style.display = "none";

            // carrega lista de entrevistas
            carregarListaEntrevistas();

            montarSelectTema();
        } finally {
            esconderLoading();
        }
    }
</script>

<script>
    async function carregarListaEntrevistas() {
        mostrarLoading();

        try {
            const auth = getAuth();

            const res = await fetch(`${SCRIPT_URL}?list=1&entrevistador=${auth.entrevistador}&_senha=${encodeURIComponent(auth.senha)}`);

            const lista = await res.json();

            const select = document.getElementById("listaEntrevistas");

            select.innerHTML = '<option value="">Selecione uma entrevista</option>';

            lista.forEach((item) => {
                const opt = document.createElement("option");
                opt.value = item.id;
                opt.text = item.entrevistado + " - " + TEMAS[item.tema_mudanca].label;
                select.appendChild(opt);
            });

            /* document.getElementById("listaEntrevistas").addEventListener("change", (e) => {
                const id = e.target.value;
                if (!id) return;

                carregarFormularioPorId(id);
            }); */
        } finally {
            esconderLoading();
        }
    }

    function carregarSelecionada() {
        const id = document.getElementById("listaEntrevistas").value;
        if (!id) return alert("Selecione uma entrevista");

        carregarFormularioPorId(id);
    }

    function novoFormulario() {
        limparFormulario();
        document.getElementById("listaEntrevistas").value = "";
    }
</script>

<script>
    function montarSelectTema() {
        const select = document.getElementById("tema_mudanca");
        select.innerHTML = '<option value="">Selecione o tema</option>';

        Object.entries(TEMAS).forEach(([key, tema]) => {
            const opt = document.createElement("option");
            opt.value = key;
            opt.text = tema.label;
            opt.dataset.hint = tema.hint;
            select.appendChild(opt);
        });
    }
</script>
<script>
    function abrirDialogCarregar() {
        document.getElementById("dialogCarregar").style.display = "flex";
    }

    function fecharDialogCarregar() {
        document.getElementById("dialogCarregar").style.display = "none";
    }

    function confirmarCarregarEntrevista() {
        const select = document.getElementById("listaEntrevistas");
        const id = select.value;

        if (!id) {
            alert("Selecione uma entrevista");
            return;
        }

        fecharDialogCarregar();
        carregarFormularioPorId(id);
    }
</script>
