---
layout: default
title: Formulário Goals Errors Train
---

<div class="neuro-form">
    <!-- ===== ABAS ===== -->
    <div class="neuro-tabs">
        <div class="neuro-tab active" onclick="openTab(this, 'intencoes')">Intençâo</div>
        <div class="neuro-tab" onclick="openTab(this, 'modelo')">Modelo</div>
        <div class="neuro-tab" onclick="openTab(this, 'erros')">Erros</div>
        <div class="neuro-tab" onclick="openTab(this, 'treino')">Treino</div>
    </div>

    <form>
        <input type="hidden" name="formulario_id" id="formulario_id" />
        <!-- =========================
     CONTEXTO COMUM
     ========================= -->
        <div class="neuro-form__section">
            <h3>Contexto da entrevista</h3>
            <div class="neuro-row">
                <div class="neuro-col">
                    <input class="neuro-input" name="entrevistador" placeholder="Entrevistador" />
                </div>
                <div class="neuro-col">
                    <input class="neuro-input" name="entrevistado" placeholder="Entrevistado" />
                </div>
            </div>

            <input class="neuro-input" name="tema_mudanca" placeholder="Tema da mudança" />
        </div>

        <!-- =========================
     FORMULÁRIO 1 – INTENÇÕES
     ========================= -->
        <div class="neuro-tab-content active" id="intencoes">
            <div class="neuro-form__section">
                <h3>Intenção genuína</h3>
                <p>Também chamada de “intenção manifesta”. Onde está a minha/nossa dopamina?</p>
                <textarea class="neuro-textarea neuro-textarea--large" name="intencao_genuina"></textarea>
            </div>

            <div class="neuro-form__section">
                <h3>Intenção desejada</h3>
                <p>É necessário ajustar a intenção genuína? Se sim, qual a nova intenção?</p>
                <textarea class="neuro-textarea neuro-textarea--large" name="intencao_desejada"></textarea>
            </div>

            <div class="neuro-form__section">
                <h3>Intenções concorrentes</h3>
                <p>Quais intenções (vetores de força) antagonizam a intenção genuína?</p>
                <textarea class="neuro-textarea" name="intencoes_concorrentes_1"></textarea>
                <textarea class="neuro-textarea" name="intencoes_concorrentes_2"></textarea>
                <textarea class="neuro-textarea" name="intencoes_concorrentes_3"></textarea>
            </div>
        </div>

        <!-- =========================
     FORMULÁRIO 2 – MODELO
     ========================= -->
        <div class="neuro-tab-content" id="modelo">
            <div class="neuro-form__section">
                <h3>Quem é o seu modelo?</h3>
                <input class="neuro-input" name="modelo" />
            </div>

            <div class="neuro-form__section">
                <h3>Comportamentos do modelo</h3>
                <textarea class="neuro-textarea" name="modelo_comportamento_1"></textarea>
                <textarea class="neuro-textarea" name="modelo_comportamento_2"></textarea>
                <textarea class="neuro-textarea" name="modelo_comportamento_3"></textarea>
            </div>
        </div>

        <!-- =========================
     FORMULÁRIO 3 – ERROS
     ========================= -->
        <div class="neuro-tab-content" id="erros">
            <div class="neuro-form__section">
                <h3>Pilar 2 – Erros</h3>

                <table class="neuro-table">
                    <tr>
                        <th>Comportamento</th>
                        <th>Nomear erro</th>
                        <th>Reconhecer</th>
                        <th>Aceitar</th>
                    </tr>

                    <tr>
                        <td>Comportamento 1</td>
                        <td><textarea class="neuro-textarea neuro-textarea--wide" name="erro_nome_1"></textarea></td>
                        <td class="checkbox-cell"><input type="checkbox" name="erro_reconhecer_1" class="neuro-checkbox" /></td>
                        <td class="checkbox-cell"><input type="checkbox" name="erro_aceitar_1" class="neuro-checkbox" /></td>
                    </tr>

                    <tr>
                        <td>Comportamento 2</td>
                        <td><textarea class="neuro-textarea neuro-textarea--wide" name="erro_nome_2"></textarea></td>
                        <td class="checkbox-cell"><input type="checkbox" name="erro_reconhecer_2" class="neuro-checkbox" /></td>
                        <td class="checkbox-cell"><input type="checkbox" name="erro_aceitar_2" class="neuro-checkbox" /></td>
                    </tr>

                    <tr>
                        <td>Comportamento 3</td>
                        <td><textarea class="neuro-textarea neuro-textarea--wide" name="erro_nome_3"></textarea></td>
                        <td class="checkbox-cell"><input type="checkbox" name="erro_reconhecer_3" class="neuro-checkbox" /></td>
                        <td class="checkbox-cell"><input type="checkbox" name="erro_aceitar_3" class="neuro-checkbox" /></td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- =========================
     FORMULÁRIO 4 – TREINO
     ========================= -->
        <div class="neuro-tab-content" id="treino">
            <div class="neuro-form__section">
                <h3>Detalhamento do erro</h3>

                <select class="neuro-input" onchange="mostrarErro(this.value)">
                    <option value="">Selecione o comportamento</option>
                    <option value="1">Comportamento 1</option>
                    <option value="2">Comportamento 2</option>
                    <option value="3">Comportamento 3</option>
                </select>
            </div>

            <div id="erro-1" class="erro-detalhe" style="display: none">
                <p>Quando este erro ocorre?</p>
                <textarea class="neuro-textarea" name="erro_quando_1"></textarea>

                <p>Por que ele ocorre?</p>
                <textarea class="neuro-textarea" name="erro_porque_1"></textarea>

                <p>Estímulos emocionais / sinais de alerta</p>
                <textarea class="neuro-textarea" name="erro_estimulos_1"></textarea>

                <p>Quão próximo estou/estamos de atingir o comportamento?</p>
                <div class="neuro-proximidade">
                    <label><input type="radio" name="erro_proximidade_1" value="0" /> 0%</label>
                    <label><input type="radio" name="erro_proximidade_1" value="25" /> 25%</label>
                    <label><input type="radio" name="erro_proximidade_1" value="50" /> 50%</label>
                    <label><input type="radio" name="erro_proximidade_1" value="75" /> 75%</label>
                    <label><input type="radio" name="erro_proximidade_1" value="100" /> 100%</label>
                </div>
            </div>

            <div id="erro-2" class="erro-detalhe" style="display: none">
                <p>Quando este erro ocorre?</p>
                <textarea class="neuro-textarea" name="erro_quando_2"></textarea>

                <p>Por que ele ocorre?</p>
                <textarea class="neuro-textarea" name="erro_porque_2"></textarea>

                <p>Estímulos emocionais / sinais de alerta</p>
                <textarea class="neuro-textarea" name="erro_estimulos_2"></textarea>

                <p>Quão próximo estou/estamos de atingir o comportamento?</p>
                <div class="neuro-proximidade">
                    <label><input type="radio" name="erro_proximidade_2" value="0" /> 0%</label>
                    <label><input type="radio" name="erro_proximidade_2" value="25" /> 25%</label>
                    <label><input type="radio" name="erro_proximidade_2" value="50" /> 50%</label>
                    <label><input type="radio" name="erro_proximidade_2" value="75" /> 75%</label>
                    <label><input type="radio" name="erro_proximidade_2" value="100" /> 100%</label>
                </div>
            </div>

            <div id="erro-3" class="erro-detalhe" style="display: none">
                <p>Quando este erro ocorre?</p>
                <textarea class="neuro-textarea" name="erro_quando_3"></textarea>

                <p>Por que ele ocorre?</p>
                <textarea class="neuro-textarea" name="erro_porque_3"></textarea>

                <p>Estímulos emocionais / sinais de alerta</p>
                <textarea class="neuro-textarea" name="erro_estimulos_3"></textarea>

                <p>Quão próximo estou/estamos de atingir o comportamento?</p>
                <div class="neuro-proximidade">
                    <label><input type="radio" name="erro_proximidade_3" value="0" /> 0%</label>
                    <label><input type="radio" name="erro_proximidade_3" value="25" /> 25%</label>
                    <label><input type="radio" name="erro_proximidade_3" value="50" /> 50%</label>
                    <label><input type="radio" name="erro_proximidade_3" value="75" /> 75%</label>
                    <label><input type="radio" name="erro_proximidade_3" value="100" /> 100%</label>
                </div>
            </div>
        </div>

        <button type="button" class="neuro-button" onclick="salvarFormulario()">Salvar formulário</button>
    </form>
</div>

<div id="loading-overlay" style="display: none">
    <div class="spinner"></div>
</div>

<script>
    function openTab(tabElement, contentId) {
        // remove active de todas as abas
        document.querySelectorAll(".neuro-tab").forEach((t) => t.classList.remove("active"));

        // remove active de todos os conteúdos
        document.querySelectorAll(".neuro-tab-content").forEach((c) => c.classList.remove("active"));

        // ativa a aba clicada
        tabElement.classList.add("active");

        // ativa o conteúdo correspondente
        document.getElementById(contentId).classList.add("active");
    }

    function mostrarErro(valor) {
        // esconde todos os blocos de erro
        document.querySelectorAll(".erro-detalhe").forEach((div) => (div.style.display = "none"));

        // se nada foi selecionado, não mostra nada
        if (!valor) return;

        // mostra o bloco correspondente
        const alvo = document.getElementById("erro-" + valor);
        if (alvo) {
            alvo.style.display = "block";
        }
    }
</script>

<script>
    // codigo implantacao AKfycbx-Oi_qSeSTX5dkaWwdi_ov945C8cbcCMDe2Toa7kX3Jo52zqjT7JHDpcLDSVnpzk8u
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxR6BdUR2ZjmwCkM3uyocf2OqdXatp77kCOAypzQl1k8OTuB_Iqve_sxbXZf82lLi39/exec";
</script>

<script>
    function coletarFormulario() {
        const dados = {};

        document.querySelectorAll("[name]").forEach((el) => {
            if (el.type === "checkbox") {
                dados[el.name] = el.checked;
            } else if (el.type === "radio") {
                if (el.checked) dados[el.name] = el.value;
            } else {
                dados[el.name] = el.value;
            }
        });

        return dados;
    }
</script>

<script>
    async function salvarFormulario() {
        mostrarLoading();

        try {
            const dados = coletarFormulario();
            const id = document.getElementById("formulario_id").value;

            const method = id ? "PUT" : "POST";
            const url = id ? `${SCRIPT_URL}?id=${id}` : SCRIPT_URL;

            const response = await fetch(url, {
                method,
                body: JSON.stringify(dados),
            });

            const json = await response.json();

            alert(id ? "Formulário atualizado" : "Formulário salvo");

            if (!id) limparFormulario();
        } finally {
            esconderLoading();
        }
    }
</script>

<script>
    function limparFormulario() {
        document.querySelectorAll("[name]").forEach((el) => {
            if (el.type === "checkbox" || el.type === "radio") {
                el.checked = false;
            } else {
                el.value = "";
            }
        });

        // garante limpeza explícita do ID
        const hiddenId = document.getElementById("formulario_id");
        if (hiddenId) hiddenId.value = "";

        // opcional: voltar para a primeira aba
        document.querySelectorAll(".neuro-tab").forEach((t) => t.classList.remove("active"));
        document.querySelectorAll(".neuro-tab-content").forEach((c) => c.classList.remove("active"));

        document.querySelector(".neuro-tab").classList.add("active");
        document.querySelector(".neuro-tab-content").classList.add("active");
    }
</script>

<script>
    function getQueryParam(nome) {
        const params = new URLSearchParams(window.location.search);
        return params.get(nome);
    }
</script>

<script>
    async function carregarFormularioPorId(id) {
        mostrarLoading();
        document.getElementById("formulario_id").value = registros[0].formulario_id;

        try {
            const response = await fetch(`${SCRIPT_URL}?id=${id}`);
            const registros = await response.json();

            if (!registros.length) {
                alert("Formulário não encontrado");
                return;
            }

            const payload = JSON.parse(registros[0].payload);

            Object.entries(payload).forEach(([k, v]) => {
                const elements = document.querySelectorAll(`[name="${k}"]`);
                if (!elements.length) return;

                elements.forEach((el) => {
                    if (el.type === "checkbox") {
                        el.checked = Boolean(v);
                    } else if (el.type === "radio") {
                        el.checked = String(el.value) === String(v);
                    } else {
                        el.value = v;
                    }
                });
            });
        } finally {
            esconderLoading();
        }
    }
</script>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const id = getQueryParam("id");
        if (id) {
            carregarFormularioPorId(id);
        }
    });
</script>

<script>
    function mostrarLoading() {
        document.getElementById("loading-overlay").style.display = "flex";
    }

    function esconderLoading() {
        document.getElementById("loading-overlay").style.display = "none";
    }
</script>
